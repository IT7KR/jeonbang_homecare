"""
ëŒ€í•œë¯¼êµ­ í–‰ì •êµ¬ì—­ ì‹œë“œ ë°ì´í„°
2024ë…„ ê¸°ì¤€ ì‹œ/ë„ â†’ ì‹œ/êµ°/êµ¬

Usage:
    python -m scripts.seed_regions
"""

import sys
import os

# Add parent directory to path
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from sqlalchemy.orm import Session
from app.core.database import SessionLocal, engine, Base
from app.models.region import Province, District

# ëŒ€í•œë¯¼êµ­ í–‰ì •êµ¬ì—­ ë°ì´í„°
KOREA_REGIONS = [
    {
        "code": "11",
        "name": "ì„œìš¸íŠ¹ë³„ì‹œ",
        "short_name": "ì„œìš¸",
        "sort_order": 1,
        "districts": [
            {"code": "11010", "name": "ì¢…ë¡œêµ¬"},
            {"code": "11020", "name": "ì¤‘êµ¬"},
            {"code": "11030", "name": "ìš©ì‚°êµ¬"},
            {"code": "11040", "name": "ì„±ë™êµ¬"},
            {"code": "11050", "name": "ê´‘ì§„êµ¬"},
            {"code": "11060", "name": "ë™ëŒ€ë¬¸êµ¬"},
            {"code": "11070", "name": "ì¤‘ë‘êµ¬"},
            {"code": "11080", "name": "ì„±ë¶êµ¬"},
            {"code": "11090", "name": "ê°•ë¶êµ¬"},
            {"code": "11100", "name": "ë„ë´‰êµ¬"},
            {"code": "11110", "name": "ë…¸ì›êµ¬"},
            {"code": "11120", "name": "ì€í‰êµ¬"},
            {"code": "11130", "name": "ì„œëŒ€ë¬¸êµ¬"},
            {"code": "11140", "name": "ë§ˆí¬êµ¬"},
            {"code": "11150", "name": "ì–‘ì²œêµ¬"},
            {"code": "11160", "name": "ê°•ì„œêµ¬"},
            {"code": "11170", "name": "êµ¬ë¡œêµ¬"},
            {"code": "11180", "name": "ê¸ˆì²œêµ¬"},
            {"code": "11190", "name": "ì˜ë“±í¬êµ¬"},
            {"code": "11200", "name": "ë™ì‘êµ¬"},
            {"code": "11210", "name": "ê´€ì•…êµ¬"},
            {"code": "11220", "name": "ì„œì´ˆêµ¬"},
            {"code": "11230", "name": "ê°•ë‚¨êµ¬"},
            {"code": "11240", "name": "ì†¡íŒŒêµ¬"},
            {"code": "11250", "name": "ê°•ë™êµ¬"},
        ],
    },
    {
        "code": "26",
        "name": "ë¶€ì‚°ê´‘ì—­ì‹œ",
        "short_name": "ë¶€ì‚°",
        "sort_order": 2,
        "districts": [
            {"code": "26010", "name": "ì¤‘êµ¬"},
            {"code": "26020", "name": "ì„œêµ¬"},
            {"code": "26030", "name": "ë™êµ¬"},
            {"code": "26040", "name": "ì˜ë„êµ¬"},
            {"code": "26050", "name": "ë¶€ì‚°ì§„êµ¬"},
            {"code": "26060", "name": "ë™ë˜êµ¬"},
            {"code": "26070", "name": "ë‚¨êµ¬"},
            {"code": "26080", "name": "ë¶êµ¬"},
            {"code": "26090", "name": "í•´ìš´ëŒ€êµ¬"},
            {"code": "26100", "name": "ì‚¬í•˜êµ¬"},
            {"code": "26110", "name": "ê¸ˆì •êµ¬"},
            {"code": "26120", "name": "ê°•ì„œêµ¬"},
            {"code": "26130", "name": "ì—°ì œêµ¬"},
            {"code": "26140", "name": "ìˆ˜ì˜êµ¬"},
            {"code": "26150", "name": "ì‚¬ìƒêµ¬"},
            {"code": "26160", "name": "ê¸°ì¥êµ°"},
        ],
    },
    {
        "code": "27",
        "name": "ëŒ€êµ¬ê´‘ì—­ì‹œ",
        "short_name": "ëŒ€êµ¬",
        "sort_order": 3,
        "districts": [
            {"code": "27010", "name": "ì¤‘êµ¬"},
            {"code": "27020", "name": "ë™êµ¬"},
            {"code": "27030", "name": "ì„œêµ¬"},
            {"code": "27040", "name": "ë‚¨êµ¬"},
            {"code": "27050", "name": "ë¶êµ¬"},
            {"code": "27060", "name": "ìˆ˜ì„±êµ¬"},
            {"code": "27070", "name": "ë‹¬ì„œêµ¬"},
            {"code": "27080", "name": "ë‹¬ì„±êµ°"},
            {"code": "27090", "name": "êµ°ìœ„êµ°"},
        ],
    },
    {
        "code": "28",
        "name": "ì¸ì²œê´‘ì—­ì‹œ",
        "short_name": "ì¸ì²œ",
        "sort_order": 4,
        "districts": [
            {"code": "28010", "name": "ì¤‘êµ¬"},
            {"code": "28020", "name": "ë™êµ¬"},
            {"code": "28030", "name": "ë¯¸ì¶”í™€êµ¬"},
            {"code": "28040", "name": "ì—°ìˆ˜êµ¬"},
            {"code": "28050", "name": "ë‚¨ë™êµ¬"},
            {"code": "28060", "name": "ë¶€í‰êµ¬"},
            {"code": "28070", "name": "ê³„ì–‘êµ¬"},
            {"code": "28080", "name": "ì„œêµ¬"},
            {"code": "28090", "name": "ê°•í™”êµ°"},
            {"code": "28100", "name": "ì˜¹ì§„êµ°"},
        ],
    },
    {
        "code": "29",
        "name": "ê´‘ì£¼ê´‘ì—­ì‹œ",
        "short_name": "ê´‘ì£¼",
        "sort_order": 5,
        "districts": [
            {"code": "29010", "name": "ë™êµ¬"},
            {"code": "29020", "name": "ì„œêµ¬"},
            {"code": "29030", "name": "ë‚¨êµ¬"},
            {"code": "29040", "name": "ë¶êµ¬"},
            {"code": "29050", "name": "ê´‘ì‚°êµ¬"},
        ],
    },
    {
        "code": "30",
        "name": "ëŒ€ì „ê´‘ì—­ì‹œ",
        "short_name": "ëŒ€ì „",
        "sort_order": 6,
        "districts": [
            {"code": "30010", "name": "ë™êµ¬"},
            {"code": "30020", "name": "ì¤‘êµ¬"},
            {"code": "30030", "name": "ì„œêµ¬"},
            {"code": "30040", "name": "ìœ ì„±êµ¬"},
            {"code": "30050", "name": "ëŒ€ë•êµ¬"},
        ],
    },
    {
        "code": "31",
        "name": "ìš¸ì‚°ê´‘ì—­ì‹œ",
        "short_name": "ìš¸ì‚°",
        "sort_order": 7,
        "districts": [
            {"code": "31010", "name": "ì¤‘êµ¬"},
            {"code": "31020", "name": "ë‚¨êµ¬"},
            {"code": "31030", "name": "ë™êµ¬"},
            {"code": "31040", "name": "ë¶êµ¬"},
            {"code": "31050", "name": "ìš¸ì£¼êµ°"},
        ],
    },
    {
        "code": "36",
        "name": "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ",
        "short_name": "ì„¸ì¢…",
        "sort_order": 8,
        "districts": [
            {"code": "36010", "name": "ì„¸ì¢…ì‹œ"},
        ],
    },
    {
        "code": "41",
        "name": "ê²½ê¸°ë„",
        "short_name": "ê²½ê¸°",
        "sort_order": 9,
        "districts": [
            {"code": "41010", "name": "ìˆ˜ì›ì‹œ"},
            {"code": "41020", "name": "ì„±ë‚¨ì‹œ"},
            {"code": "41030", "name": "ì˜ì •ë¶€ì‹œ"},
            {"code": "41040", "name": "ì•ˆì–‘ì‹œ"},
            {"code": "41050", "name": "ë¶€ì²œì‹œ"},
            {"code": "41060", "name": "ê´‘ëª…ì‹œ"},
            {"code": "41070", "name": "í‰íƒì‹œ"},
            {"code": "41080", "name": "ë™ë‘ì²œì‹œ"},
            {"code": "41090", "name": "ì•ˆì‚°ì‹œ"},
            {"code": "41100", "name": "ê³ ì–‘ì‹œ"},
            {"code": "41110", "name": "ê³¼ì²œì‹œ"},
            {"code": "41120", "name": "êµ¬ë¦¬ì‹œ"},
            {"code": "41130", "name": "ë‚¨ì–‘ì£¼ì‹œ"},
            {"code": "41140", "name": "ì˜¤ì‚°ì‹œ"},
            {"code": "41150", "name": "ì‹œí¥ì‹œ"},
            {"code": "41160", "name": "êµ°í¬ì‹œ"},
            {"code": "41170", "name": "ì˜ì™•ì‹œ"},
            {"code": "41180", "name": "í•˜ë‚¨ì‹œ"},
            {"code": "41190", "name": "ìš©ì¸ì‹œ"},
            {"code": "41200", "name": "íŒŒì£¼ì‹œ"},
            {"code": "41210", "name": "ì´ì²œì‹œ"},
            {"code": "41220", "name": "ì•ˆì„±ì‹œ"},
            {"code": "41230", "name": "ê¹€í¬ì‹œ"},
            {"code": "41240", "name": "í™”ì„±ì‹œ"},
            {"code": "41250", "name": "ê´‘ì£¼ì‹œ"},
            {"code": "41260", "name": "ì–‘ì£¼ì‹œ"},
            {"code": "41270", "name": "í¬ì²œì‹œ"},
            {"code": "41280", "name": "ì—¬ì£¼ì‹œ"},
            {"code": "41290", "name": "ì—°ì²œêµ°"},
            {"code": "41300", "name": "ê°€í‰êµ°"},
            {"code": "41310", "name": "ì–‘í‰êµ°"},
        ],
    },
    {
        "code": "51",
        "name": "ê°•ì›íŠ¹ë³„ìì¹˜ë„",
        "short_name": "ê°•ì›",
        "sort_order": 10,
        "districts": [
            {"code": "51010", "name": "ì¶˜ì²œì‹œ"},
            {"code": "51020", "name": "ì›ì£¼ì‹œ"},
            {"code": "51030", "name": "ê°•ë¦‰ì‹œ"},
            {"code": "51040", "name": "ë™í•´ì‹œ"},
            {"code": "51050", "name": "íƒœë°±ì‹œ"},
            {"code": "51060", "name": "ì†ì´ˆì‹œ"},
            {"code": "51070", "name": "ì‚¼ì²™ì‹œ"},
            {"code": "51080", "name": "í™ì²œêµ°"},
            {"code": "51090", "name": "íš¡ì„±êµ°"},
            {"code": "51100", "name": "ì˜ì›”êµ°"},
            {"code": "51110", "name": "í‰ì°½êµ°"},
            {"code": "51120", "name": "ì •ì„ êµ°"},
            {"code": "51130", "name": "ì² ì›êµ°"},
            {"code": "51140", "name": "í™”ì²œêµ°"},
            {"code": "51150", "name": "ì–‘êµ¬êµ°"},
            {"code": "51160", "name": "ì¸ì œêµ°"},
            {"code": "51170", "name": "ê³ ì„±êµ°"},
            {"code": "51180", "name": "ì–‘ì–‘êµ°"},
        ],
    },
    {
        "code": "43",
        "name": "ì¶©ì²­ë¶ë„",
        "short_name": "ì¶©ë¶",
        "sort_order": 11,
        "districts": [
            {"code": "43010", "name": "ì²­ì£¼ì‹œ"},
            {"code": "43020", "name": "ì¶©ì£¼ì‹œ"},
            {"code": "43030", "name": "ì œì²œì‹œ"},
            {"code": "43040", "name": "ë³´ì€êµ°"},
            {"code": "43050", "name": "ì˜¥ì²œêµ°"},
            {"code": "43060", "name": "ì˜ë™êµ°"},
            {"code": "43070", "name": "ì¦í‰êµ°"},
            {"code": "43080", "name": "ì§„ì²œêµ°"},
            {"code": "43090", "name": "ê´´ì‚°êµ°"},
            {"code": "43100", "name": "ìŒì„±êµ°"},
            {"code": "43110", "name": "ë‹¨ì–‘êµ°"},
        ],
    },
    {
        "code": "44",
        "name": "ì¶©ì²­ë‚¨ë„",
        "short_name": "ì¶©ë‚¨",
        "sort_order": 12,
        "districts": [
            {"code": "44010", "name": "ì²œì•ˆì‹œ"},
            {"code": "44020", "name": "ê³µì£¼ì‹œ"},
            {"code": "44030", "name": "ë³´ë ¹ì‹œ"},
            {"code": "44040", "name": "ì•„ì‚°ì‹œ"},
            {"code": "44050", "name": "ì„œì‚°ì‹œ"},
            {"code": "44060", "name": "ë…¼ì‚°ì‹œ"},
            {"code": "44070", "name": "ê³„ë£¡ì‹œ"},
            {"code": "44080", "name": "ë‹¹ì§„ì‹œ"},
            {"code": "44090", "name": "ê¸ˆì‚°êµ°"},
            {"code": "44100", "name": "ë¶€ì—¬êµ°"},
            {"code": "44110", "name": "ì„œì²œêµ°"},
            {"code": "44120", "name": "ì²­ì–‘êµ°"},
            {"code": "44130", "name": "í™ì„±êµ°"},
            {"code": "44140", "name": "ì˜ˆì‚°êµ°"},
            {"code": "44150", "name": "íƒœì•ˆêµ°"},
        ],
    },
    {
        "code": "52",
        "name": "ì „ë¶íŠ¹ë³„ìì¹˜ë„",
        "short_name": "ì „ë¶",
        "sort_order": 13,
        "districts": [
            {"code": "52010", "name": "ì „ì£¼ì‹œ"},
            {"code": "52020", "name": "êµ°ì‚°ì‹œ"},
            {"code": "52030", "name": "ìµì‚°ì‹œ"},
            {"code": "52040", "name": "ì •ìì‹œ"},
            {"code": "52050", "name": "ë‚¨ì›ì‹œ"},
            {"code": "52060", "name": "ê¹€ì œì‹œ"},
            {"code": "52070", "name": "ì™„ì£¼êµ°"},
            {"code": "52080", "name": "ì§„ì•ˆêµ°"},
            {"code": "52090", "name": "ë¬´ì£¼êµ°"},
            {"code": "52100", "name": "ì¥ìˆ˜êµ°"},
            {"code": "52110", "name": "ì„ì‹¤êµ°"},
            {"code": "52120", "name": "ìˆœì°½êµ°"},
            {"code": "52130", "name": "ê³ ì°½êµ°"},
            {"code": "52140", "name": "ë¶€ì•ˆêµ°"},
        ],
    },
    {
        "code": "46",
        "name": "ì „ë¼ë‚¨ë„",
        "short_name": "ì „ë‚¨",
        "sort_order": 14,
        "districts": [
            {"code": "46010", "name": "ëª©í¬ì‹œ"},
            {"code": "46020", "name": "ì—¬ìˆ˜ì‹œ"},
            {"code": "46030", "name": "ìˆœì²œì‹œ"},
            {"code": "46040", "name": "ë‚˜ì£¼ì‹œ"},
            {"code": "46050", "name": "ê´‘ì–‘ì‹œ"},
            {"code": "46060", "name": "ë‹´ì–‘êµ°"},
            {"code": "46070", "name": "ê³¡ì„±êµ°"},
            {"code": "46080", "name": "êµ¬ë¡€êµ°"},
            {"code": "46090", "name": "ê³ í¥êµ°"},
            {"code": "46100", "name": "ë³´ì„±êµ°"},
            {"code": "46110", "name": "í™”ìˆœêµ°"},
            {"code": "46120", "name": "ì¥í¥êµ°"},
            {"code": "46130", "name": "ê°•ì§„êµ°"},
            {"code": "46140", "name": "í•´ë‚¨êµ°"},
            {"code": "46150", "name": "ì˜ì•”êµ°"},
            {"code": "46160", "name": "ë¬´ì•ˆêµ°"},
            {"code": "46170", "name": "í•¨í‰êµ°"},
            {"code": "46180", "name": "ì˜ê´‘êµ°"},
            {"code": "46190", "name": "ì¥ì„±êµ°"},
            {"code": "46200", "name": "ì™„ë„êµ°"},
            {"code": "46210", "name": "ì§„ë„êµ°"},
            {"code": "46220", "name": "ì‹ ì•ˆêµ°"},
        ],
    },
    {
        "code": "47",
        "name": "ê²½ìƒë¶ë„",
        "short_name": "ê²½ë¶",
        "sort_order": 15,
        "districts": [
            {"code": "47010", "name": "í¬í•­ì‹œ"},
            {"code": "47020", "name": "ê²½ì£¼ì‹œ"},
            {"code": "47030", "name": "ê¹€ì²œì‹œ"},
            {"code": "47040", "name": "ì•ˆë™ì‹œ"},
            {"code": "47050", "name": "êµ¬ë¯¸ì‹œ"},
            {"code": "47060", "name": "ì˜ì£¼ì‹œ"},
            {"code": "47070", "name": "ì˜ì²œì‹œ"},
            {"code": "47080", "name": "ìƒì£¼ì‹œ"},
            {"code": "47090", "name": "ë¬¸ê²½ì‹œ"},
            {"code": "47100", "name": "ê²½ì‚°ì‹œ"},
            {"code": "47110", "name": "ì˜ì„±êµ°"},
            {"code": "47120", "name": "ì²­ì†¡êµ°"},
            {"code": "47130", "name": "ì˜ì–‘êµ°"},
            {"code": "47140", "name": "ì˜ë•êµ°"},
            {"code": "47150", "name": "ì²­ë„êµ°"},
            {"code": "47160", "name": "ê³ ë ¹êµ°"},
            {"code": "47170", "name": "ì„±ì£¼êµ°"},
            {"code": "47180", "name": "ì¹ ê³¡êµ°"},
            {"code": "47190", "name": "ì˜ˆì²œêµ°"},
            {"code": "47200", "name": "ë´‰í™”êµ°"},
            {"code": "47210", "name": "ìš¸ì§„êµ°"},
            {"code": "47220", "name": "ìš¸ë¦‰êµ°"},
        ],
    },
    {
        "code": "48",
        "name": "ê²½ìƒë‚¨ë„",
        "short_name": "ê²½ë‚¨",
        "sort_order": 16,
        "districts": [
            {"code": "48010", "name": "ì°½ì›ì‹œ"},
            {"code": "48020", "name": "ì§„ì£¼ì‹œ"},
            {"code": "48030", "name": "í†µì˜ì‹œ"},
            {"code": "48040", "name": "ì‚¬ì²œì‹œ"},
            {"code": "48050", "name": "ê¹€í•´ì‹œ"},
            {"code": "48060", "name": "ë°€ì–‘ì‹œ"},
            {"code": "48070", "name": "ê±°ì œì‹œ"},
            {"code": "48080", "name": "ì–‘ì‚°ì‹œ"},
            {"code": "48090", "name": "ì˜ë ¹êµ°"},
            {"code": "48100", "name": "í•¨ì•ˆêµ°"},
            {"code": "48110", "name": "ì°½ë…•êµ°"},
            {"code": "48120", "name": "ê³ ì„±êµ°"},
            {"code": "48130", "name": "ë‚¨í•´êµ°"},
            {"code": "48140", "name": "í•˜ë™êµ°"},
            {"code": "48150", "name": "ì‚°ì²­êµ°"},
            {"code": "48160", "name": "í•¨ì–‘êµ°"},
            {"code": "48170", "name": "ê±°ì°½êµ°"},
            {"code": "48180", "name": "í•©ì²œêµ°"},
        ],
    },
    {
        "code": "50",
        "name": "ì œì£¼íŠ¹ë³„ìì¹˜ë„",
        "short_name": "ì œì£¼",
        "sort_order": 17,
        "districts": [
            {"code": "50010", "name": "ì œì£¼ì‹œ"},
            {"code": "50020", "name": "ì„œê·€í¬ì‹œ"},
        ],
    },
]


def seed_regions(db: Session) -> None:
    """ì§€ì—­ ë°ì´í„° ì‹œë“œ"""
    print("ğŸŒ± ì§€ì—­ ë°ì´í„° ì‹œë“œ ì‹œì‘...")

    # ê¸°ì¡´ ë°ì´í„° í™•ì¸
    existing_provinces = db.query(Province).count()
    if existing_provinces > 0:
        print(f"  âš ï¸  ì´ë¯¸ {existing_provinces}ê°œ ì‹œ/ë„ ë°ì´í„°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.")
        response = input("  ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì‹œë“œí• ê¹Œìš”? (y/N): ")
        if response.lower() != "y":
            print("  ì‹œë“œ ì·¨ì†Œë¨")
            return
        # ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
        db.query(District).delete()
        db.query(Province).delete()
        db.commit()
        print("  ê¸°ì¡´ ë°ì´í„° ì‚­ì œ ì™„ë£Œ")

    # ì‹œ/ë„ ë° ì‹œ/êµ°/êµ¬ ì‚½ì…
    total_provinces = 0
    total_districts = 0

    for region in KOREA_REGIONS:
        # ì‹œ/ë„ ì‚½ì…
        province = Province(
            code=region["code"],
            name=region["name"],
            short_name=region["short_name"],
            sort_order=region["sort_order"],
            is_active=True,
        )
        db.add(province)
        total_provinces += 1

        # ì‹œ/êµ°/êµ¬ ì‚½ì…
        for idx, district_data in enumerate(region["districts"]):
            district = District(
                code=district_data["code"],
                province_code=region["code"],
                name=district_data["name"],
                sort_order=idx + 1,
                is_active=True,
            )
            db.add(district)
            total_districts += 1

    db.commit()
    print(f"âœ… ì‹œë“œ ì™„ë£Œ: {total_provinces}ê°œ ì‹œ/ë„, {total_districts}ê°œ ì‹œ/êµ°/êµ¬")


def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    # í…Œì´ë¸” ìƒì„± (ì—†ëŠ” ê²½ìš°)
    Base.metadata.create_all(bind=engine)

    # ì„¸ì…˜ ìƒì„±
    db = SessionLocal()
    try:
        seed_regions(db)
    finally:
        db.close()


if __name__ == "__main__":
    main()
